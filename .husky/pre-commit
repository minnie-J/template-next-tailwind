#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# ë³´í˜¸ ë¸Œëœì¹˜ì— ì»¤ë°‹í•˜ê³  ìˆëŠ”ì§€ ì—¬ë¶€ ì²´í¬
echo "\n>> Pre-commit Hook: Checking branch name...\n"

# í˜„ì¬ ì²´í¬ì•„ì›ƒëœ ë¸Œëœì¹˜
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)
# ì»¤ë°‹í•˜ë©´ ì•ˆë˜ëŠ” ë¸Œëœì¹˜
PROTECTED_BRANCHES="main dev"

echo "ë³´í˜¸ ë¸Œëœì¹˜(ë“¤): $PROTECTED_BRANCHES"
echo "í˜„ì¬ ë¸Œëœì¹˜: $CURRENT_BRANCH\n"

for BRANCH in $PROTECTED_BRANCHES
do
  # í˜„ì¬ ë¸Œëœì¹˜ê°€ ë³´í˜¸ ë¸Œëœì¹˜ë©´ ì»¤ë°‹ ì·¨ì†Œ ì²˜ë¦¬
  if [ "$BRANCH" = "$CURRENT_BRANCH" ]
  then
    echo "ğŸš« ë³´í˜¸ ë¸Œëœì¹˜ì— ì§ì ‘ ì»¤ë°‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
    echo "ğŸš« ì‹ ê·œ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ì—¬ ì»¤ë°‹í•´ì£¼ì„¸ìš”!\n"
    exit 1
    break
  fi
done

echo ">> Finish checking branch name.\n"

exit 0

# í¬ë§·íŒ…/ë¦°íŒ…(í˜„ì¬ ìŠ¤í…Œì´ì§• ë˜ì–´ìˆëŠ” íŒŒì¼ë§Œ)
npx lint-staged

